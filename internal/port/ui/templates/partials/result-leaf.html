{{ define "leaf" }}

{{ if .Leaf.SerialNumber }}
<label>Certificate SerialNumber
    <div role="group">
        <input
                id="cert-serial"
                type="text"
                value="{{ .Leaf.SerialNumber }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="cert-serial"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}

<label>Fingerprint</label>
    <div role="group">
        <input
            id="cert-fingerprint"
            type="text"
            value="{{ .Leaf.Fingerprint }}"
            aria-label="Read-only input"
            readonly
        >
        <a href="#" role="button" class="secondary" data-copy-on-click="cert-fingerprint"><div class="icon-copy"></div></a>
    </div>

{{ if .Leaf.IssuerName }}
<label>Issuer
    <div role="group">
        <input
                id="issuer"
                type="text"
                value="{{ .Leaf.IssuerName }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="issuer"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}
<hr/>

<h4>Subject DN</h4>
<label>Common Name
    <div role="group">
        <input
                id="cn"
                type="text"
                value="{{ .Leaf.DN.CommonName }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="cn"><div class="icon-copy"></div></a>
    </div>
</label>

{{ if .Leaf.DN.SerialNumber }}
<label>SerialNumber
    <div role="group">
        <input
                id="serial"
                type="text"
                value="{{ .Leaf.DN.SerialNumber }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="serial"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}

{{ if .Leaf.DN.Country }}
<label>Country
    <div role="group">
        <input
                id="country"
                type="text"
                value="{{ .Leaf.DN.Country }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="country"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}
{{ if .Leaf.DN.State }}
<label>State
    <div role="group">
        <input
                id="state"
                type="text"
                value="{{ .Leaf.DN.State }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="state"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}
{{ if .Leaf.DN.Locality }}
<label>Locality
    <div role="group">
        <input
                id="locality"
                type="text"
                value="{{ .Leaf.DN.Locality }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="locality"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}
{{ if .Leaf.DN.Organization }}
<label>Organization
    <div role="group">
        <input
                id="org"
                type="text"
                value="{{ .Leaf.DN.Organization }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="org"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}
{{ if .Leaf.DN.OrganizationalUnit }}
<label>Organizational Unit
    <div role="group">
        <input
                id="ou"
                type="text"
                value="{{ .Leaf.DN.OrganizationalUnit }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="ou"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}
{{ if .Leaf.DN.EmailAddress }}
<label>Email Address
    <div role="group">
        <input
                id="email"
                type="text"
                value="{{ .Leaf.DN.EmailAddress }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="email"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}
<hr/>
<h4>Validity</h4>
{{ if .Leaf.NotBefore }}
<label>Not Before
    <div role="group">
        <input
                id="nb"
                type="text"
                value="{{ .Leaf.NotBefore }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="nb"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}

{{ if .Leaf.NotAfter }}
<label>Not After
    <div role="group">
        <input
                id="na"
                type="text"
                value="{{ .Leaf.NotAfter }}"
                aria-label="Read-only input"
                readonly
        />
        <a href="#" role="button" class="secondary" data-copy-on-click="na"><div class="icon-copy"></div></a>
    </div>
</label>
{{ end }}

<hr/>
{{ if gt (len .Leaf.SubjectAlternativeNames) 0 }}
<h5>SAN</h5>
{{ range $i, $value := .Leaf.SubjectAlternativeNames }}
<div role="group">
    <input
            id="san_{{ $i }}"
            type="text"
            value="{{ $value }}"
            aria-label="Read-only input"
            readonly
    />
    <a href="#" role="button" class="secondary" data-copy-on-click="san_{{ $i }}"><div class="icon-copy"></div></a>
</div>
{{ end }}
{{ end }}

<hr/>
<h4>Public Key</h4>
{{ if gt (len .Leaf.KeyUsages) 0 }}
<h5>Key Usage</h5>
{{ range $i, $value := .Leaf.KeyUsages }}
<div role="group">
    <input
            id="ku_{{ $i}}"
            type="text"
            value="{{ $value }}"
            aria-label="Read-only input"
            readonly
    />
    <a href="#" role="button" class="secondary" data-copy-on-click="ku_{{ $i }}"><div class="icon-copy"></div></a>
</div>
{{ end }}
{{ end }}

<label>Fingerprint</label>
<div role="group">
    <input
        id="key-fingerprint"
        type="text"
        value="{{ .Leaf.PublicKey.Fingerprint }}"
        aria-label="Read-only input"
        readonly
    />
    <a href="#" role="button" class="secondary" data-copy-on-click="key-fingerprint"><div class="icon-copy"></div></a>
</div>

<label>Type</label>
<div role="group">
    <input
        id="key-type"
        type="text"
        value="{{ .Leaf.PublicKey.Type }}"
        aria-label="Read-only input"
        readonly
    />
    <a href="#" role="button" class="secondary" data-copy-on-click="key-type"><div class="icon-copy"></div></a>
</div>

{{ if gt (len .Leaf.Raw) 0 }}
<details closed>
    <summary role="button" class="secondary">Raw</summary>
    <article style="white-space: pre-wrap;">{{ .Leaf.Raw }}</article>
</details>
{{ end }}

{{ end }}
